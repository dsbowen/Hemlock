<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>Validate - Hemlock</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../../css/theme.css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  <link href="../../css/extra.css" rel="stylesheet" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Validate";
    var mkdocs_page_input_path = "tutorial/validate.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Hemlock</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../manifesto/">Why hemlock?</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../contact/">Contact</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../checklist/">Checklist</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Tutorial</span></p>
                <ul class="current">
                    <li class="toctree-l1"><a class="reference internal" href="../intro/">Introduction</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../first_project/">Your first project</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../run_local/">Running hemlock locally</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../qpolymorphs/">Question polymorphs</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../data/">Data</a>
                    </li>
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Validate</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#native-html-validation">Native HTML validation</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#native-hemlock-validation">Native hemlock validation</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#custom-validation">Custom validation</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#code-explanation">Code explanation</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#validation-in-our-app">Validation in our app</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#summary">Summary</a>
    </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../submit/">Submit</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../extensions/">Extensions</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../compile/">Compile</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../navigate/">Navigate</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../page_logic/">Page logic</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../comp_check/">Comprehension check</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../random_ass/">Random assignment</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../proposer_branch/">Proposer branch</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../responder_branch/">Responder branch</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../debug/">Debugging</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../deploy/">Deployment</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../extra/">Bells and whistles</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Setup</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../setup/win/">Windows</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../setup/wsl/">Windows Subsystem for Linux</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../setup/mac/">Mac</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../setup/linux/">Linux</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Application</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../app/">Setting and initialization</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../debug/">Debugging</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Functions</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../functions/compile/">Compile</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../functions/debug/">Debug</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../functions/submit/">Submit</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../functions/validate/">Validate</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Models</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../models/bases/">Bases</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../models/branch/">Branch</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../models/embedded/">Embedded data and timers</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../models/functions/">Function models</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../models/page/">Page</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../models/participant/">Participant</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../models/question/">Question</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../models/worker/">Worker</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Question polymorphs</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../questions/bases/">Bases</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../questions/blank/">Blank</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../questions/check/">Check</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../questions/choice/">Choice</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../questions/dashboard/">Dashboard</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../questions/download/">Download</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../questions/file/">File upload</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../questions/input/">Input</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../questions/label/">Label</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../questions/range/">Range</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../questions/select/">Select</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../questions/textarea/">Textarea</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Tools</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../tools/comprehension/">Comprehension check</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../tools/lang/">Language</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../tools/mturk/">MTurk</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../tools/navbar/">Navbar</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../tools/random/">Randomization</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../tools/statics/">Statics</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../tools/titrate/">Titrate</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../tools/utils/">Utilities</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../security/">Security</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../changelog/">Changelog</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../acknowledgements/">Acknowledgements</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Hemlock</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Tutorial &raquo;</li>
        
      
    
    <li>Validate</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/dsbowen/hemlock/edit/master/docs_md/tutorial/validate.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="validation">Validation</h1>
<p>In the previous part of the tutorial, you learned how to store and download data.</p>
<p>By the end of this part of the tutorial, you'll be able to validate participant responses.</p>
<p>Click here to see what your <a href="https://github.com/dsbowen/hemlock-tutorial/blob/v0.3/blackboard.ipynb" target="_blank"><code>blackboard.ipynb</code></a> and <a href="https://github.com/dsbowen/hemlock-tutorial/blob/v0.3/survey.py" target="_blank"><code>survey.py</code></a> files should look like at the end of this part of the tutorial.</p>
<details class="note"><summary>Why validation?</summary><p>I often run studies where I elicit numerical estimates. Early on, I noticed that a small but annoying faction of participants, rather than entering actual numbers (e.g., 50), answered the question in full sentences:</p>
<blockquote>
<p>I believe the answer is fifty.</p>
</blockquote>
<p>We often need to make sure participants are entering the right kind of answer, whether it's typing the same password twice, answering a comprehension check by clicking on the correct choice, or entering a number instead of a word.</p>
</details>
<h2 id="native-html-validation">Native HTML validation</h2>
<p>You've already seen native HTML validation when you specified the type of input participants could enter (e.g., <code>type='number'</code>) or restricted the numerical range of their responses (e.g., <code>min=0</code>, <code>max=10</code>).</p>
<p>You'll often want to require participants to respond to certain questions. For <code>Input</code> questions, you can do this using native HTML validation. Open jupyter notebook and run the following:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">hemlock</span> <span class="kn">import</span> <span class="n">Page</span><span class="p">,</span> <span class="n">Input</span>

<span class="n">Page</span><span class="p">(</span>
    <span class="n">Input</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">preview</span><span class="p">()</span>
</code></pre></div>
<p>This opens a page with a blank input. Click '&gt;&gt;' without filling it in. Notice that you get an error message. Fill in the input, click '&gt;&gt;' again, and notice that you don't get the error message this time.</p>
<details class="note"><summary>Learn more about native HTML attributes</summary><p>You can set the HTML attributes of most question polymorphs by passing arguments to the constructor or by setting their attributes. Enter the following in a cell and run it.</p>
<div class="highlight"><pre><span></span><code><span class="n">Input</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">input_attrs</span>
</code></pre></div>
<p>Out:</p>
<div class="highlight"><pre><span></span><code>{&#39;class&#39;: [&#39;form-control&#39;], &#39;type&#39;: &#39;text&#39;, &#39;required&#39;: True}
</code></pre></div>
<p>This is a dictionary of attributes for the HTML input tag. Check out <a href="https://www.w3schools.com/html/html_form_attributes.asp" target="_blank">this resourse</a> for a full list of input tag attributes.</p>
</details>
<h2 id="native-hemlock-validation">Native hemlock validation</h2>
<p>Hemlock provides an extensive library of validation functions beyond those of standard HTML.</p>
<p>To see the limitations of native HTML validation, preview this page:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">hemlock</span> <span class="kn">import</span> <span class="n">Check</span>

<span class="n">Page</span><span class="p">(</span>
    <span class="n">Check</span><span class="p">(</span>
        <span class="s1">&#39;Pick one&#39;</span><span class="p">,</span>
        <span class="p">[</span><span class="s1">&#39;World&#39;</span><span class="p">,</span> <span class="s1">&#39;Moon&#39;</span><span class="p">,</span> <span class="s1">&#39;Sun&#39;</span><span class="p">],</span>
        <span class="n">required</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">preview</span><span class="p">()</span>
</code></pre></div>
<p>Click '&gt;&gt;' without checking any of the choices. Notice that there's no error message. Native HTML would have let you continue the survey without responding.</p>
<p>Hemlock's validation functions overcome problems like this. You can add validation functions to a page or question by passing a <code>validate</code> argument to its constructor or by setting its <code>validate</code> attribute. Validate functions run when a participant attempts to submit a page. If the participant's response is valid, the function returns <code>None</code>, allowing the participant to continue the survey. If the participant's response is invalid, the function returns an error message.</p>
<p>Let's use hemlock's validation to require a response to the check question from above:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">hemlock</span> <span class="kn">import</span> <span class="n">Validate</span> <span class="k">as</span> <span class="n">V</span>

<span class="n">check</span> <span class="o">=</span> <span class="n">Check</span><span class="p">(</span>
    <span class="s1">&#39;Pick one!&#39;</span><span class="p">,</span>
    <span class="p">[</span><span class="s1">&#39;World&#39;</span><span class="p">,</span> <span class="s1">&#39;Moon&#39;</span><span class="p">,</span> <span class="s1">&#39;Star&#39;</span><span class="p">],</span>
    <span class="n">validate</span><span class="o">=</span><span class="n">V</span><span class="o">.</span><span class="n">require</span><span class="p">()</span>
<span class="p">)</span>
<span class="n">check</span><span class="o">.</span><span class="n">validate</span>
</code></pre></div>
<p>Out:</p>
<div class="highlight"><pre><span></span><code>[&lt;require()&gt;]
</code></pre></div>
<p>We can verify that the check question doesn't have a response or an error message yet.</p>
<div class="highlight"><pre><span></span><code><span class="n">check</span><span class="o">.</span><span class="n">response</span><span class="p">,</span> <span class="n">check</span><span class="o">.</span><span class="n">error</span>
</code></pre></div>
<p>Out:</p>
<div class="highlight"><pre><span></span><code>(None, None)
</code></pre></div>
<p>Let's run the validate function. Because the check has no response, the validate function will return an error message. The check stores the error message in its <code>error</code> attribute.</p>
<div class="highlight"><pre><span></span><code><span class="n">check</span><span class="o">.</span><span class="n">_validate</span><span class="p">()</span>
<span class="n">check</span><span class="o">.</span><span class="n">error</span>
</code></pre></div>
<p>Out:</p>
<div class="highlight"><pre><span></span><code>&#39;Please respond to this question.&#39;
</code></pre></div>
<p>Now suppose the participant's response was <code>'World'</code> (i.e., the participant clicked 'World'), and re-run the validate function.</p>
<div class="highlight"><pre><span></span><code><span class="n">check</span><span class="o">.</span><span class="n">response</span> <span class="o">=</span> <span class="s1">&#39;World&#39;</span>
<span class="n">check</span><span class="o">.</span><span class="n">_validate</span><span class="p">()</span>
<span class="n">check</span><span class="o">.</span><span class="n">error</span>
</code></pre></div>
<p>No error message this time!</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You don't need to run <code>_validate</code> yourself in the survey. Hemlock takes care of this automatically for you.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">More validate functions</p>
<p><code>require</code> is just one of many <a href="../../functions/validate/">native hemlock validate functions</a>.</p>
</div>
<h2 id="custom-validation">Custom validation</h2>
<p>Hemlock also allows you to easily write custom validation functions.</p>
<p>For example, some of my early research involved asking participants to make two different estimates of the same quantity (don't ask, long story). I needed to validate that their second estimate was different from their first. Here's how I did it:</p>
<div class="highlight"><pre><span></span><code><span class="nd">@V</span><span class="o">.</span><span class="n">register</span>
<span class="k">def</span> <span class="nf">different_second_estimate</span><span class="p">(</span><span class="n">second_estimate</span><span class="p">,</span> <span class="n">first_estimate</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">second_estimate</span><span class="o">.</span><span class="n">response</span> <span class="o">==</span> <span class="n">first_estimate</span><span class="o">.</span><span class="n">response</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;Make sure your second estimate is different from your first&#39;</span>

<span class="n">first_estimate</span> <span class="o">=</span> <span class="n">Input</span><span class="p">(</span>
    <span class="s1">&#39;Enter your first esimate&#39;</span><span class="p">,</span>
    <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;number&#39;</span>
<span class="p">)</span>
<span class="n">second_estimate</span> <span class="o">=</span> <span class="n">Input</span><span class="p">(</span>
    <span class="s1">&#39;Enter a second estimate which is different from your first&#39;</span><span class="p">,</span>
    <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;number&#39;</span><span class="p">,</span>
    <span class="n">validate</span><span class="o">=</span><span class="n">V</span><span class="o">.</span><span class="n">different_second_estimate</span><span class="p">(</span><span class="n">first_estimate</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></div>
<p>If the responses to the first and second estimate inputs are the same, the validate function returns an error message:</p>
<div class="highlight"><pre><span></span><code><span class="n">first_estimate</span><span class="o">.</span><span class="n">response</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">second_estimate</span><span class="o">.</span><span class="n">response</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">second_estimate</span><span class="o">.</span><span class="n">_validate</span><span class="p">()</span>
<span class="n">second_estimate</span><span class="o">.</span><span class="n">error</span>
</code></pre></div>
<p>Out:</p>
<div class="highlight"><pre><span></span><code>&#39;Make sure your second estimate is different from your first&#39;
</code></pre></div>
<p>Let's see what happens when the participant's responses to the first and second estimate question are different:</p>
<div class="highlight"><pre><span></span><code><span class="n">first_estimate</span><span class="o">.</span><span class="n">response</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">second_estimate</span><span class="o">.</span><span class="n">response</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">second_estimate</span><span class="o">.</span><span class="n">_validate</span><span class="p">()</span>
<span class="n">second_estimate</span><span class="o">.</span><span class="n">error</span>
</code></pre></div>
<p>No error message this time!</p>
<h3 id="code-explanation">Code explanation</h3>
<p>First, we register a new validate function with the <code>@V.register</code> decorator. The validate function takes two arguments: the second and first estimate <code>Input</code> objects. The function checks if the responses to these inputs are the same and, if they are, returns an error message.</p>
<p>Next, we create two inputs for the first and second estimate. We attach the validate function to the second estimate by passing <code>validate=V.different_second_estimate(first_estimate)</code> to its constructor.</p>
<p>Importantly, <code>V.my_function</code> does <em>not</em> return the result of <code>my_function</code>. <code>V.my_function</code> returns an object which evaluates <code>my_function</code> when a participant submits a page. <code>V.my_function</code> basically returns a sticky note reminding the survey to run <code>my_function</code> at the appropriate time. Pages and questions store these sticky notes in their <code>validate</code> attribute.</p>
<p>Note that <code>different_second_estimate</code> takes two arguments (the second and first estimate) but <code>V.different_second_estimate</code> only takes one (the first estimate). What's going on? In general, validate functions take their 'parent' (the page or question to which they belong) as their first argument. The arguments passed to <code>V.my_function</code> will be passed to <code>my_function</code> <em>after</em> the parent. For example:</p>
<div class="highlight"><pre><span></span><code><span class="nd">@V</span><span class="o">.</span><span class="n">register</span>
<span class="k">def</span> <span class="nf">my_function</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">my_argument</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;My parent is&#39;</span><span class="p">,</span> <span class="n">parent</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;My argument is&#39;</span><span class="p">,</span> <span class="n">my_argument</span><span class="p">)</span>

<span class="n">inpt</span> <span class="o">=</span> <span class="n">Input</span><span class="p">(</span><span class="n">validate</span><span class="o">=</span><span class="n">V</span><span class="o">.</span><span class="n">my_function</span><span class="p">(</span><span class="s1">&#39;hello world&#39;</span><span class="p">))</span>
<span class="n">inpt</span>
</code></pre></div>
<p>Out:</p>
<div class="highlight"><pre><span></span><code>&lt;Input (transient 139890227379456)&gt;
</code></pre></div>
<p>In:</p>
<div class="highlight"><pre><span></span><code><span class="n">inpt</span><span class="o">.</span><span class="n">_validate</span><span class="p">()</span>
</code></pre></div>
<p>Out:</p>
<div class="highlight"><pre><span></span><code>My parent is &lt;Input (transient 139890227379456)&gt;
My argument is hello world
</code></pre></div>
<p>Notice that the 'parent' is the input associated with the validation function (look at the digits after 'transient').</p>
<p>The same pattern holds for the other function models (submit, compile, and navigate functions) we will see in the coming sections.</p>
<h2 id="validation-in-our-app">Validation in our app</h2>
<p>Now that we've seen how to add validation in our notebook, let's add it to our app. Your goal is to require responses to each of the demographics questions.</p>
<p>In <code>survey.py</code>:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">hemlock</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">Binary</span><span class="p">,</span> <span class="n">Branch</span><span class="p">,</span> <span class="n">Check</span><span class="p">,</span> <span class="n">Input</span><span class="p">,</span> <span class="n">Page</span><span class="p">,</span> <span class="n">Label</span><span class="p">,</span> <span class="n">RangeInput</span><span class="p">,</span> <span class="n">Select</span><span class="p">,</span> 
    <span class="n">Validate</span> <span class="k">as</span> <span class="n">V</span><span class="p">,</span> <span class="n">route</span>
<span class="p">)</span>

<span class="nd">@route</span><span class="p">(</span><span class="s1">&#39;/survey&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">start</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">Branch</span><span class="p">(</span>
        <span class="n">Page</span><span class="p">(</span>
            <span class="n">Input</span><span class="p">(</span>
                <span class="s1">&#39;&lt;p&gt;Enter your month and year of birth.&lt;/p&gt;&#39;</span><span class="p">,</span>
                <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;month&#39;</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="s1">&#39;DoB&#39;</span><span class="p">,</span> <span class="n">data_rows</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span>
            <span class="p">),</span>
            <span class="n">Select</span><span class="p">(</span>
                <span class="s1">&#39;&lt;p&gt;What is your gender?&lt;/p&gt;&#39;</span><span class="p">,</span>
                <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;Male&#39;</span><span class="p">,</span> <span class="s1">&#39;Female&#39;</span><span class="p">,</span> <span class="s1">&#39;Other&#39;</span><span class="p">],</span>
                <span class="n">var</span><span class="o">=</span><span class="s1">&#39;Gender&#39;</span><span class="p">,</span> <span class="n">data_rows</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">validate</span><span class="o">=</span><span class="n">V</span><span class="o">.</span><span class="n">require</span><span class="p">()</span>
            <span class="p">),</span>
            <span class="c1"># REST OF THE DEMOGRAPHICS PAGE HERE</span>
        <span class="p">),</span>
        <span class="n">Page</span><span class="p">(</span>
            <span class="n">Label</span><span class="p">(</span><span class="s1">&#39;&lt;p&gt;Thank you for completing the survey!&lt;/p&gt;&#39;</span><span class="p">),</span> 
            <span class="n">terminal</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>
    <span class="p">)</span>
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Tips for adding validation to your survey</p>
<ol>
<li>We can add a blank option <code>''</code> to the gender select question and use <code>validate=V.require()</code> to require participants to select <code>'Male'</code>, <code>'Female'</code>, or <code>'Other'</code>.</li>
<li>For the input questions (date of birth, number of children, income level), use native HTML validation, <code>required=True</code>.</li>
<li>For questions that ask you to select one choice (gender, primary wage earner), use <code>validate=V.require()</code>.</li>
<li>For questions that ask you to select at least one choice (race), use <code>validate=V.min_len(1)</code>. This means, 'select a minimum of 1 choice'.</li>
</ol>
</div>
<p>Run the app again. Try to continue past the demographics page without filling in some of the questions, and see your validation at work!</p>
<div class="admonition tip">
<p class="admonition-title">Multiple validate functions</p>
<p>You can attach multiple validation functions to a page or question by setting <code>validate</code> to a list of functions. Validate functions run in the order in which you add them, stopping with the first validate function that returns an error.</p>
</div>
<h2 id="summary">Summary</h2>
<p>In this part of the tutorial, you learned how to validate participant responses.</p>
<p>In the next part of the tutorial, you'll learn how to run submit functions to modify participant data after they submit a page.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../submit/" class="btn btn-neutral float-right" title="Submit">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../data/" class="btn btn-neutral" title="Data"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/dsbowen/hemlock/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../data/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../submit/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js" defer></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
